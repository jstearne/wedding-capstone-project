{% extends 'base.html' %} {% block content %}
<br>
<h3>Guestbook</h3>




<!--Two column format: left is all posts, right is static post form: https://getbootstrap.com/docs/5.1/layout/columns/ -->
<div class="container">
    <div class="row">
        <div class="col"> <!--Left half of page-->
<br><br>
<a href="{% url 'guestbook_create' %}">Leave a Message</a>
<br><br>
    <!--POST LOOP-->
        {% for post in posts %}
        <!--Bootstrap card for every post in DB-->
            <div class="card">
                <div class="card-header">TITLE: {{ post.title }}</div>
                <div class="card-body">
                    <blockquote class="blockquote mb-0">
                        <p>BODY: {{ post.body }}</p>
                        <p>Created: {{ post.created_at }}</p>
                        <footer class="blockquote-footer">POST AUTHOR: {{ post.user.guest.name }} 
                        <cite title="Source Title">( RSVP'D: {{post.user.guest.rsvp}} )</cite></footer>
                    </blockquote>
                    <a href="{% url 'guestbook_update' post.pk %}">Edit</a>&nbsp; &nbsp; 
                    <a href="{% url 'guestbook_delete' post.pk %}">Delete</a>
                    <br><br>




<!--TEST MODAL: deletes the LAST post no matter what. How the heck?-->

<!-- Button trigger modal -->
<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
    TEST DELETE
  </button>
  
  <!-- Modal: Seems to have fixed problem, two classes per modal fade to allow class=targetting of object.pk -->
  <div class="modal fade" id="staticBackdrop" class="modalDelete{{ obj.pk }}" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="staticBackdropLabel">Delete?</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-footer">
          <!--Delete functionality-->
          <form action="{% url 'guestbook_delete' post.pk %}" data-target=".modalDelete{{ obj.pk }}" method="POST">
            {% csrf_token %}
            <button class="btn btn-danger">Delete</button>
          </form>
          <!--Delete functionality-->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary">Confirm</button>
        </div>
      </div>
    </div>
  </div>
<!--TEST MODAL-->


                </div>
            </div>
        <!--END Bootstrap card-->
        {% endfor %}
        <!--END POST LOOP-->
        </div>

        <!--Create Post on Right side of page-->
        <div class="col"> <!--Right half of page-->
            <br>
            This is the right side of the page!<br>
            <br>
            <br>
        </div>
    </div>
<!--End of right column-->
    <br><br>
    <a href="{% url 'guestbook_create' %}">Leave a Message</a>
    <br><br>
    <hr class="solid">
</div>
<!--END OF TWO COLUMNS (footer underneath, optional)-->



















Syntax reminders...<br>

Currently logged in user: "{user.username}"" = "{ user.username }" <br>

Currently logged in user RSVPD?: "{user.guest.rsvp}" = "{ user.guest.rsvp }"<br>

Original post author: "{ post.user.username }" <br>

Original post author RSVP: "{ post.user.guest.rsvp }"

I may need to add an author-field to posts to get 'post-author'...

{% endblock %} 

